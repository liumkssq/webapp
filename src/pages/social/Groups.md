# Groups.vue 文件说明文档

## 📄 文件概述

`Groups.vue` 是校园交换平台中的群组管理页面组件，负责展示用户加入的群组列表，并提供创建群组、加入群组等功能。该页面是社交功能中群聊管理的核心入口，支持用户进行群组相关的各种操作。

## 📦 所属包

该文件位于 `src/pages/social` 目录下，是社交功能模块的主要页面组件之一。它管理群组相关的用户界面和交互逻辑。

## 🔍 核心结构

### 模板结构 (template)

1. **页面布局**：
   - 头部导航：显示标题和返回按钮
   - 操作按钮：创建群组和加入群组按钮
   - 群组列表：显示已加入的群组
   - 底部导航：应用通用导航栏
   - 弹窗组件：创建群组、加入群组和好友选择弹窗

2. **主要组件**：
   - `HeaderNav`：顶部导航组件
   - `FooterNav`：底部导航组件
   - `van-button`：操作按钮组件
   - `van-list`：列表加载组件
   - `van-cell`：列表项组件
   - `van-dialog`：对话框组件
   - `van-popup`：弹出层组件
   - `van-form`：表单组件
   - `van-checkbox-group`：复选框组组件

### 脚本结构 (script)

1. **状态管理**：
   - `groupList`：用户加入的群组列表
   - `loading`：加载状态控制
   - `finished`：列表是否加载完成标识
   - `groupForm`：创建群组的表单数据
   - `joinForm`：加入群组的表单数据
   - `selectedFriends`：创建群组时选择的好友列表

2. **弹窗控制**：
   - `showCreateDialog`：控制创建群组弹窗
   - `showJoinDialog`：控制加入群组弹窗
   - `showFriendsPopup`：控制好友选择弹出层

3. **方法**：
   - 群组数据：`loadGroups`、`loadMoreGroups`
   - 群组操作：`createGroup`、`joinGroup`、`enterGroupChat`
   - 好友选择：`showFriendSelector`、`toggleFriendSelection`、`confirmSelectedFriends`
   - 辅助功能：`getGroupInitials`、`getInitials`、`beforeDialogClose`

## 🔁 主要逻辑流程

1. **页面初始化流程**：
   - 组件挂载时加载群组列表数据
   - 显示群组列表，包括群名称、成员数量、未读消息等信息
   - 根据用户角色（创建者/管理员/普通成员）显示不同标识

2. **创建群组流程**：
   - 用户点击"创建群组"按钮
   - 弹出创建群组对话框
   - 填写群组名称、群公告
   - 选择要邀请的好友
   - 提交创建群组请求

3. **加入群组流程**：
   - 用户点击"加入群组"按钮
   - 弹出加入群组对话框
   - 输入群组ID和验证消息
   - 提交加入群组请求

4. **好友选择流程**：
   - 点击"选择好友"按钮
   - 弹出好友选择弹出层
   - 支持搜索和勾选好友
   - 确认选择后返回好友列表

## 📌 特别说明

1. **群组数据结构**：
   - 包含ID、名称、头像、成员数量等基本信息
   - 包含用户角色信息（创建者/管理员/普通成员）
   - 包含未读消息数量，方便用户关注新消息

2. **群组状态标识**：
   - 官方群组显示认证标识
   - 创建者和管理员有特殊标识
   - 有未读消息的群组显示消息数量标记

3. **模拟数据处理**：
   - 当前实现使用模拟数据进行展示
   - 实际项目中需替换为API调用，从后端获取真实数据
   - 保留了API调用的结构，便于后续集成

4. **好友选择优化**：
   - 支持搜索过滤好友列表
   - 使用复选框实现多选功能
   - 选中好友显示数量提示
   - 保存临时选择状态，取消不影响已确认的选择

5. **表单验证**：
   - 群组名称为必填项
   - 在对话框关闭前验证表单数据
   - 验证失败时阻止对话框关闭并提示错误

6. **性能考虑**：
   - 实现了分页加载机制，优化大量群组时的性能
   - 好友选择支持搜索过滤，提高大量好友时的使用体验
   - 列表项采用懒加载策略，减少初始渲染负担