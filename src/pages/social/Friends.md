# Friends.vue 文件说明文档

## 📄 文件概述

`Friends.vue` 是校园交换平台中的好友列表页面组件，负责展示和管理用户的好友关系。该页面为用户提供了好友列表查看、分类筛选、搜索好友以及执行好友相关操作的功能界面。

## 📦 所属包

该文件位于 `src/pages/social` 目录下，是社交功能模块的主要页面组件之一。它展示好友数据并提供好友管理的用户界面。

## 🔍 核心结构

### 模板结构 (template)

1. **页面布局**：
   - 头部导航：显示标题和操作按钮
   - 搜索栏：用于筛选好友列表
   - 操作按钮：添加好友、查看好友请求等
   - 好友分类：在线好友和全部好友
   - 底部导航：应用通用导航栏

2. **主要组件**：
   - `HeaderNav`：顶部导航组件
   - `FooterNav`：底部导航组件
   - `van-search`：搜索框组件
   - `van-empty`：空状态提示组件
   - `van-dialog`：对话框组件
   - `van-action-sheet`：操作菜单组件

### 脚本结构 (script)

1. **状态管理**：
   - `filteredFriends`：根据搜索条件筛选的好友列表
   - `searchKeyword`：搜索关键词
   - `activeTab`：当前活动的标签页
   - `loading`：加载状态控制
   - `showActionSheet`：控制操作菜单显示

2. **计算属性**：
   - `onlineFriends`：获取在线好友列表
   - `allFriends`：获取所有好友列表
   - `hasOnlineFriends`：判断是否有在线好友

3. **方法**：
   - 好友数据加载：`loadFriendList`、`loadOnlineFriends`
   - 好友筛选：`filterFriends`、`clearSearch`
   - 好友操作：`handleFriendAction`、`navigateToChat`
   - 好友管理：`setFriendRemark`、`deleteFriend`

## 🔁 主要逻辑流程

1. **页面初始化流程**：
   - 组件挂载时加载好友列表数据
   - 加载在线好友数据
   - 加载好友请求未读数量
   - 设置初始的活动标签页

2. **好友交互流程**：
   - 点击好友头像或名称查看详细资料
   - 点击聊天图标进入与该好友的聊天界面
   - 点击更多图标显示操作菜单
   - 通过操作菜单设置备注或删除好友

3. **好友搜索流程**：
   - 在搜索框输入关键词
   - 实时过滤匹配关键词的好友
   - 点击清除按钮重置搜索结果

## 📌 特别说明

1. **数据加载策略**：
   - 利用Pinia store缓存机制，避免频繁请求
   - 首次加载或强制刷新时才请求新数据
   - 支持下拉刷新更新好友列表

2. **性能优化**：
   - 使用计算属性进行好友筛选，提高渲染性能
   - 实现虚拟列表，优化大量好友时的渲染性能
   - 延迟加载好友头像，减少初始加载时间

3. **交互设计**：
   - 在线好友优先展示，提高用户体验
   - 实现下拉刷新和触底加载更多
   - 提供视觉反馈，如加载状态、空状态提示

4. **扩展功能**：
   - 支持好友分组管理（预留接口）
   - 支持好友备注功能
   - 支持好友在线状态实时更新